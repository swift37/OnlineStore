@model OnlineStore.MVC.Models.CatalogViewModel

@{
    ViewData["Title"] = $"{Model.FiltersGroup?.Category?.Name}";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section styles {
    <link rel="stylesheet" href="~/css/double-slider.min.css" asp-append-version="true" />
}

<div class="single-category">
    <div class="container">
        <div class="wrapper">
            <div class="column">
                <div class="holder">
                    <div class="row sidebar">
                        <div class="filter">
                            @if (Model.FiltersGroup?.SpecificationTypes.Count > 0)
                                foreach (var type in Model.FiltersGroup.SpecificationTypes)
                                    @await Component.InvokeAsync("FilterBlock", new { model = type })

                            <div class="filter-block pricing">
                                <h4>Price</h4>
                                <div class="ds-container">
                                    <div class="range-inputs">
                                        <div class="ds-field">
                                            <input type="number" id="minPriceInput" min="0" max="15000" value="0" />
                                        </div>
                                        <div class="ds-separator">—</div>
                                        <div class="ds-field">
                                            <input type="number" id="maxPriceInput" min="0" max="15000" value="15000" />
                                        </div>
                                    </div>
                                    <div class="double-slider">
                                        <div class="range"></div>
                                        <div class="range-sliders">
                                            <input type="range" id="minPrice" min="0" max="15000" value="0" />
                                            <input type="range" id="maxPrice" min="0" max="15000" value="15000" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="section">
                        <div class="row">
                            <div class="cat-head">
                                <div class="breadcrumb">
                                    <ul class="flexitem">
                                        <li><a asp-controller="Home" asp-action="Index">Home</a></li>
                                        @if (Model.ProductsPage?.Category != null)
                                        {
                                            <li>@Model.ProductsPage.Category.Name</li>
                                        }
                                    </ul>
                                </div>
                                <div class="page-title">
                                    <h1>@Model.ProductsPage?.Category?.Name</h1>
                                </div>
                                <div class="cat-navigation flexitem">
                                    <div class="item-filter desktop-hide">
                                        <a href="#" class="filter-trigger label">
                                            <img src="~/resources/icons/sort.png" alt="">
                                            <span>Filter</span>
                                        </a>
                                    </div>
                                    <div class="item-sortir">
                                        <div class="label">
                                            <span class="mobile-hide">Sort by <span class="selected-value">Default</span></span>
                                            <div class="desktop-hide selected-value">Default</div>
                                            <i class="angle down icon"></i>
                                        </div>
                                        <ul>
                                            <li data-option="0">Default</li>
                                            <li data-option="1">Customer rating: from the best</li>
                                            <li data-option="2">Price: from the cheapest</li>
                                            <li data-option="3">Price: from the most expensive</li>
                                        </ul>
                                    </div>
                                    <div class="item-perpage mobile-hide">
                                        <div class="label">Items @Model.ProductsPage?.Products.Count() per page</div>
                                    </div>
                                    <div class="item-options">
                                        <div class="label">
                                            <span class="mobile-hide">Show <span class="selected-value">15</span> per page</span>
                                            <div class="desktop-hide selected-value">15</div>
                                            <i class="angle down icon"></i>
                                        </div>
                                        <ul>
                                            <li data-option="15">15</li>
                                            <li data-option="20">20</li>
                                            <li data-option="25">25</li>
                                            <li data-option="30">30</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        @await Component.InvokeAsync("ProductCardsList", new { model = Model.ProductsPage?.Products })
                        <div class="pagination">
                            <button id="startBtn" class="page-btn" disabled>
                                <i class="fa-solid fa-angles-left"></i>
                            </button>
                            <button id="prevBtn" class="page-btn prevNext" disabled>
                                <i class="fa-solid fa-angle-left"></i>
                            </button>

                            <div class="page-links">
                                @if (Model.ProductsPage?.TotalPages <= 5)
                                    @for (int i = 1; i <= Model.ProductsPage?.TotalPages; i++)
                                    {
                                        <a asp-controller="Catalog" asp-action="Index" asp-route-categoryid="@Model.ProductsPage?.Category?.Id" asp-route-page="@i" class="page-link">@i</a>
                                    }
                                else
                                if (Model.ProductsPage?.CurrentPage < 5)
                                    for (int i = 1; i < 5; i++)
                                    {
                                        <a asp-route="products" asp-route-subcatid="@Model.ProductsPage.Category?.Id" asp-route-page="@i" class="page-link">@i</a>
                                    }
                                else if (Model.ProductsPage?.CurrentPage > Model.ProductsPage?.TotalPages - 4)
                                    for (int i = Model.ProductsPage.TotalPages - 4; i <= Model.ProductsPage?.TotalPages; i++)
                                    {
                                        <a asp-route="products" asp-route-subcatid="@Model.ProductsPage?.Category?.Id" asp-route-page="@i" class="page-link">@i</a>
                                    }
                                else
                                    for (int i = (Model.ProductsPage?.CurrentPage ?? default) - 2; i <= Model.ProductsPage?.CurrentPage + 2; i++)
                                    {
                                        <a asp-route="products" asp-route-subcatid="@Model.ProductsPage?.Category?.Id" asp-route-page="@i" class="page-link">@i</a>
                                    }
                            </div>

                            <button id="nextBtn" class="page-btn prevNext">
                                <i class="fa-solid fa-angle-right"></i>
                            </button>
                            <button id="endBtn" class="page-btn">
                                <i class="fa-solid fa-angles-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <script src="~/scripts/double-slider.min.js" asp-append-version="true"></script>
}